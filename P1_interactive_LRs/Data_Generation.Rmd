---
title: "Data_Generation"
author: "SÃ¸ren Orm Hansen"
date: "9/30/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(pacman)

p_load(tidyverse, ggplot2)
```


```{r}
# Defining variables

# Learning rates
ntrials <- 100

a <- c(.001, .01, .1)

EV <- matrix(0, ncol = 2, nrow = ntrials * length(a)) %>% data.frame()

x <- rnorm(ntrials, 30, 10)

for(i in 1:length(a)){
  EV[1 + (i-1)*100, 1] <- 10
}


EV$Trials <- 1:ntrials


for (i in 1:length(a)) {
  for (t in 2:ntrials) {
    EV[t, i] <- EV[t - 1, i] + a[i] * (x[t] - EV[t - 1, i])
  }
  colnames(EV)[i] <- paste('LR', a[i], sep = '_')
}


EV %>% 
  ggplot(aes(x = 1:ntrials, y = LR_0.1)) + 
  geom_line() + 
  xlab('Trial') +
  theme_minimal()

#plot(EV, type = 'l', xlab = 'trials')

```




